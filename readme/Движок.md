
![[движок_хранилище.png]]
### Движок игры

#game_engine
Игрок/админ посылает запрос, через #api игровому движку, на проведение того или иного действия(получение эффекта, выбор испытания и т.д.). Движок делает запрос к базе данных с правилами в которых описаны все возможные взаимодействия, и генерирует ответ игроку по определенному алгоритму. В зависимости от типа взаимодействия, движок выбирает алгоритм, будь то бросок кубика/монетки или выпадение предмета и многое другое. К движку подключается языковая модель. На каждого игрока выделяется свой процесс. Доступ к движку асинхронный.

Все действия происходят в отдельных потоках(один поток - один клиент) с сохранением данных во временное хранилище. Через заданный промежуток времени временное хранилище синхронизируется с постоянным. Прямой доступ к постоянному хранилище имеется только из админ панели.

![[schema_task_run.png]]

Движок занимается обработкой и передачей данных от хранилища к api.
Как пример:
	клиент отправляет запрос на обработку броска кубика с 12 гранями.
	движок понимает что это за кубик, и запускает рандомайзер для этого кубика, возвращая результат клиенту через api.
	
Клиент получает предмет в инвентарь. Движок записывает состояние инвентаря игрока в базу(redis).